\section{Билет 1.}
\section*{z-функция: определение и линейный алгоритм вычисления}
\par
\textbf{Z-функция} от строки $S$ и позиции $x$~--- это длина наидлиннейшей подстроки,
начинающейся в позиции $x$ и совпадающей с префиксом строки $S$. Далee $Z(S, x)$.
Отметим, что Z(S, 0)~--- не определен и может быть любым. Поэтому договоримся о том, что
$S.length() > 0$.

\par
Вычисление Z-функции~--- задача о нахождении всех значений, иначе говоря, найти
$Z(S, x)$ для всех $x \in \overline{1, S.length() - 1}$.

\subsection*{Алгоритм вычисления Z-функции}

Будем поддерживать переменные $l$ и $r$.
В $r$ будем хранить максимальную сумму значения Z-функции в $x$ и самого $x$ из найденных по ходу алгоритма,
а в $l$ такой максимальный $x$, что $Z(S, x) + x = r$.

\par
Найдем $Z(S, 1)$ тривиально, циклом \textbf{for}. Пусть мы нашли значения Z-функции
для $\forall x \in \overline{1, i - 1}$. Найдем значение в $i$. Рассмотрим случаи:

\begin{enumerate}
    \item $i > r$.
Найдем значение тривиально.
    \item $i \leq  r$ и $Z(S, i - l) + i \leq r$. Рассмотрим значение $y = Z(S, i - l) + i$.
Заметим, что $y \geq  Z(S, i) + i$, ведь иначе будет противоречие с найденным $r$, потому что он бы был не максимальным
либо слишком большим из-за несовпадения с префиксом. С другой стороны, $y \geq Z(S, i) + i$, из-за равенства подстрок.
Отсюда получаем, что $Z(S, i) = Z(S, i - l)$.
    \item $i \leq r$ и $Z(S, i - l) + i > r$. Здесь также будет работать второе утверждение предыдущего пункта, 
    найдем $Z(S, i)$ тривиально начиная с проверки $r+1$. Если $r+1$ не существует, выполнится первый пункт второго утверждения.
\end{enumerate}

\subsection*{Оценим время работы}
\par
Очевидно, что значение $l$ может меняться лишь тогда, когда меняется значение $r$, причем за $O(1)$.
Значение $r$ не изменяется при условии второго пункта, а в условиях первого и третьего может лишь увеличиваться,
но никогда не превзойдет длину строки. Отсюда получаем, что время работы $O(S.length())$.